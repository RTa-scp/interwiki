<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <!-- Branches' info -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/branches-info-scp.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/branches-info-wl.js"
    ></script>

    <!-- C-take's resizing iframe method -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/createResizeIframe.js"
    ></script>

    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/interwiki.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/newStyle.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/gh/scpwiki/interwiki@main/js/getWikiModule.js"
    ></script>
  </head>

  <body>
    <div class="side-block" style="display: none">
      <div class="heading">
        <p>
          <a
            id="refresh-link"
            onclick="window.location.reload(true)"
            title=""
          ></a>
        </p>
      </div>
    </div>

    <script type="text/javascript">
      // Get the community of the current page - expected to be either
      // "scp" or "wl"
      var community = getQueryString("community");

      // Get the page fullname, but without the default category
      // TODO Maybe try to rename this query parameter to 'fullname' for
      // consistency
      var pagename = getQueryString("pagename").replace(/^_default:/, "");

      // Get the list of branches for the given community
      var branches = { wl: wlBranches, scp: scpBranches }[community] || {};

      // TODO What is this?
      var siteNum = Object.keys(branches).length;

      // Get the configuration for the current branch
      // TODO Rename "site" to "currentBranch"
      var siteLang = getQueryString("lang");
      var siteData = branches[siteLang];

      // Get the Wikidot ID of the current branch
      // TODO When could this fail? Why fallback to false?
      // (This could fail if the interwiki is being used on a sandbox wiki
      // for testing, for example)
      // TODO What's this actually needed for?
      var currentBranchId = siteData ? siteData.id : false;

      // Cache of CSS strings that have been added to the stylesheet. Will
      // be used to ignore later incoming CSS if it matches already-added
      // CSS, preventing duplication
      // TODO Should probably use separate <style> elements for this and
      // then check to see if incoming CSS is identical to one; if it is,
      // move it to the top.
      // TODO Keeping all CSS in a single style element will prevent
      // @imports unless that CSS is at the very top, because @import must
      // come first.
      var styleAry = [];

      // If provided, use the style parameter to manually set the value of
      // styleType, which will be used to determine the base theme of the
      // interwiki. If not provided, pick a sensible default value.
      var styleType = getQueryString("style");
      if (styleType == "") {
        styleType = { wl: "wanderers" }[community] || "default";
      }

      var sideBlock = document.getElementsByClassName("side-block")[0];
      var inStyle = document.getElementById("internal-style");
      var cuStyle = document.getElementById("custom-style");

      bhlDarkCheck();
      switchStyleType();
      changeStyleCheck();
      addTranslations();
    </script>
    <div id="iframeset"></div>
  </body>
</html>
